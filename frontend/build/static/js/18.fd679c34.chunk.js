(this["webpackJsonpgull-react"]=this["webpackJsonpgull-react"]||[]).push([[18],{932:function(e,t,n){"use strict";n.r(t);var r=n(13),a=n.n(r),c=n(27),u=n(23),i=n(0),s=n.n(i),l=n(1107),o=n(876),m=n(48),d=n(70),p=n(906),f=n(288),b=n(1112),E=n(853),h=n(29),j=n(21),O=function(e){var t=e.orderId,n=Object(d.b)().dispatch,r=Object(E.useStripe)(),l=Object(E.useElements)(),o=Object(h.g)(),m=Object(i.useState)(null),p=Object(u.a)(m,2),f=p[0],b=p[1],O=Object(i.useState)(!1),y=Object(u.a)(O,2),g=y[0],v=y[1],x=function(){var e=Object(c.a)(a.a.mark((function e(c){var u,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c.preventDefault(),r&&l){e.next=3;break}return e.abrupt("return");case 3:return v(!0),e.next=6,Object(j.r)(t,{isPaid:!0})(n);case 6:return e.next=8,r.confirmPayment({elements:l,confirmParams:{return_url:o.push("/home")}});case 8:u=e.sent,"card_error"===(i=u.error).type||"validation_error"===i.type?b(i.message):b("An unexpected error occured."),v(!1);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return s.a.createElement("form",{id:"payment-form",onSubmit:x},s.a.createElement(E.PaymentElement,{id:"payment-element"}),s.a.createElement("button",{className:"btn btn-primary",disabled:g||!r||!l,id:"submit"},s.a.createElement("span",{id:"button-text"},g?"Processing ... ":"Pay now")),f&&s.a.createElement("div",{id:"payment-message"},f))},y=function(e){var t=e.stripePromise,n=e.clientSecret,r=Object(i.useState)(!1),a=Object(u.a)(r,2),c=a[0],l=a[1];return s.a.createElement(s.a.Fragment,null,s.a.createElement(i.Fragment,null,s.a.createElement(f.a,{className:"text-capitalize",onClick:function(){return l(!0)}},"Pay Now"),s.a.createElement(b.a,{show:c,onHide:function(){l(!1)}},s.a.createElement(b.a.Header,{closeButton:!0},s.a.createElement(b.a.Title,null,"Payment")),s.a.createElement(b.a.Body,null,n&&t&&s.a.createElement(E.Elements,{stripe:t,options:{clientSecret:n}},s.a.createElement(O,null))))))};t.default=function(e){var t=e.userId,n=e.orders,r=e.products,d=n.filter((function(e){return e.userId===t})),f=Object(i.useState)(null),b=Object(u.a)(f,2),E=b[0],h=b[1],j=Object(i.useState)(""),O=Object(u.a)(j,2),g=O[0],v=O[1];return Object(i.useEffect)((function(){fetch("http://127.0.0.1:5001/furniturebidding-9a01b/us-central1/app/config").then(function(){var e=Object(c.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:n=e.sent,r=n.publishableKey,h(Object(p.a)(r));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),console.log(E),console.log(g),Object(i.useEffect)((function(){fetch("http://127.0.0.1:5001/furniturebidding-9a01b/us-central1/app/create-payment-intent",{method:"POST",body:JSON.stringify({})}).then(function(){var e=Object(c.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:n=e.sent,r=n.clientSecret,v(r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),s.a.createElement("div",{className:"mt-5"},s.a.createElement(l.a,null,d.map((function(e){return s.a.createElement(o.a,{lg:12,md:12,sm:12,xs:12},s.a.createElement(m.d,null,s.a.createElement("div",{className:"d-flex flex-row align-items-center"},r.find((function(t){return t.id===e.productId}))&&s.a.createElement("img",{src:r.find((function(t){return t.id===e.productId})).productImages[0],style:{width:"100px",height:"100px"}}),s.a.createElement("div",{className:"d-flex flex-column ml-5"},s.a.createElement("h3",null,r.find((function(t){return t.id===e.productId}))&&r.find((function(t){return t.id===e.productId})).productName),s.a.createElement("p",null,"Amount to pay: \u20b1",e.amountToPay),e.isPaid?"Paid":s.a.createElement(y,{stripePromise:E,clientSecret:g,orderId:e.id})))))}))))}}}]);
//# sourceMappingURL=18.fd679c34.chunk.js.map