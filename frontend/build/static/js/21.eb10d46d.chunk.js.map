{"version":3,"sources":["app/views/seller/components/CreateInvoice.js"],"names":["CreateInvoice","useAuth","products","users","biddings","dispatch","id","useParams","product","find","filteredBiddings","filter","bidding","productId","findWinner","length","reduce","acc","current","bidAmount","useState","loading","setLoading","vat","setVat","totalAmount","setTotalAmount","handleSubmit","a","order","nanoid","userId","isPaid","amountToPay","created","Date","now","addOrder","routeSegments","name","className","to","variant","progress","data-style","EXPAND_LEFT","onClick","user","uid","displayName","email","scope","productName","src","productImages","style","width","height","type","value","onChange","e","target","total","calculate","Number"],"mappings":"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","file":"static/js/21.eb10d46d.chunk.js","sourcesContent":["import React, { useEffect, useState, Fragment } from \"react\";\r\nimport { Button, Form, FormControl } from \"react-bootstrap\";\r\nimport DatePicker from \"react-datepicker\";\r\nimport { Breadcrumb } from \"@gull\";\r\nimport { useAuth } from \"app/appContext\";\r\nimport { Link, useParams } from \"react-router-dom\";\r\nimport { nanoid } from \"nanoid\";\r\nimport { addOrder } from \"app/reducers/actions/FurnitureActions\";\r\nimport Swal from \"sweetalert2\";\r\nimport LaddaButton, { EXPAND_LEFT } from \"react-ladda/dist/LaddaButton\";\r\n\r\nconst CreateInvoice = () => {\r\n  const { products, users, biddings, dispatch } = useAuth();\r\n\r\n  const { id } = useParams();\r\n  const product = products.find((product) => product.id === id);\r\n  const filteredBiddings = biddings.filter(\r\n    (bidding) => bidding.productId === id\r\n  );\r\n  const findWinner =\r\n    filteredBiddings.length !== 0 &&\r\n    filteredBiddings.reduce((acc, current) => {\r\n      if (current.bidAmount > acc.bidAmount) {\r\n        return current;\r\n      } else {\r\n        return acc;\r\n      }\r\n    });\r\n  const bidAmount = findWinner.bidAmount;\r\n  const [loading, setLoading] = useState();\r\n  const [vat, setVat] = useState();\r\n  const [totalAmount, setTotalAmount] = useState();\r\n  const handleSubmit = async () => {\r\n    if (!vat && totalAmount) {\r\n    }\r\n    const order = {\r\n      id: nanoid(),\r\n      productId: id,\r\n      userId: findWinner.userId,\r\n      isPaid: false,\r\n      amountToPay: totalAmount,\r\n      created: Date.now(),\r\n    };\r\n    setLoading(true);\r\n    await addOrder(order)(dispatch);\r\n    setLoading(false);\r\n  };\r\n\r\n  const handleChange = (e) => {\r\n    setVat(e.target.value);\r\n  };\r\n  const calculate = (vat, total) => {\r\n    const VAT = total * (vat / 100);\r\n    const amount = total + VAT;\r\n    setTotalAmount(amount);\r\n  };\r\n\r\n  // const totalAmount = bidAmount + bidAmount * (vat / 100);\r\n  return (\r\n    <div>\r\n      <Breadcrumb routeSegments={[{ name: \"Create Invoice\" }]}></Breadcrumb>\r\n\r\n      {findWinner && product ? (\r\n        <div className=\"invoice-viewer py-3\">\r\n          <Fragment>\r\n            <Form className=\"px-3\">\r\n              <div className=\"viewer_actions d-flex justify-content-end\">\r\n                <div className=\"mb-4\">\r\n                  <Link\r\n                    to=\"/seller/my-products\"\r\n                    className=\"btn btn-warning mr-3 py-2\"\r\n                    variant=\"warning\"\r\n                    // onClick={() => this.props.toggleInvoiceEditor()}\r\n                  >\r\n                    Cancel\r\n                  </Link>\r\n                  <LaddaButton\r\n                    className=\"btn btn-primary\"\r\n                    loading={loading}\r\n                    progress={0.5}\r\n                    data-style={EXPAND_LEFT}\r\n                    onClick={handleSubmit}\r\n                  >\r\n                    Submit\r\n                  </LaddaButton>\r\n                </div>\r\n              </div>\r\n              <div className=\"mt-3 mb-4 border-top\"></div>\r\n              <div className=\"row mb-5\">\r\n                <div className=\"col-md-6\">\r\n                  <h5 className=\"font-weight-bold\">Bill From</h5>\r\n                  <h5>\r\n                    {users.find((user) => user.uid === product.userId)\r\n                      ? users.find((user) => user.uid === product.userId)\r\n                          .displayName\r\n                        ? users.find((user) => user.uid === product.userId)\r\n                            .displayName\r\n                        : users.find((user) => user.uid === product.userId)\r\n                            .email\r\n                      : \"No user found\"}\r\n                  </h5>\r\n                </div>\r\n\r\n                <div className=\"col-md-6 text-right\">\r\n                  <h5 className=\"font-weight-bold\">Bill To</h5>\r\n                  <h5>\r\n                    {users.find((user) => user.uid === findWinner.userId)\r\n                      ? users.find((user) => user.uid === findWinner.userId)\r\n                          .displayName\r\n                        ? users.find((user) => user.uid === findWinner.userId)\r\n                            .displayName\r\n                        : users.find((user) => user.uid === findWinner.userId)\r\n                            .email\r\n                      : \"No user found or No bids in this product\"}\r\n                  </h5>\r\n                </div>\r\n              </div>\r\n              <div className=\"row\">\r\n                <div className=\"col-md-12 table-responsive\">\r\n                  <table className=\"table table-hover mb-3\">\r\n                    <thead className=\"bg-gray-300\">\r\n                      <tr>\r\n                        <th scope=\"col\">Product Name</th>\r\n                        <th scope=\"col\">Product Image</th>\r\n                        <th scope=\"col\">Price</th>\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                      <tr>\r\n                        <td>{product.productName}</td>\r\n                        <td className=\"text-middle\">\r\n                          <img\r\n                            src={product.productImages[0]}\r\n                            style={{ width: \"100px\", height: \"100px\" }}\r\n                          />\r\n                        </td>\r\n                        <td>{findWinner.bidAmount}</td>\r\n                      </tr>\r\n                    </tbody>\r\n                  </table>\r\n                </div>\r\n                <div className=\"col-md-12\">\r\n                  <div className=\"invoice-summary invoice-summary-input float-right\">\r\n                    <p className=\"d-flex align-items-center\">\r\n                      Vat(%):\r\n                      <span>\r\n                        <FormControl\r\n                          type=\"text\"\r\n                          className=\"small-input\"\r\n                          name=\"vat\"\r\n                          value={vat}\r\n                          onChange={handleChange}\r\n                        />\r\n                      </span>\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={() =>\r\n                          calculate(Number(vat), Number(bidAmount))\r\n                        }\r\n                        className=\"btn btn-primary\"\r\n                      >\r\n                        calculate\r\n                      </button>\r\n                    </p>\r\n                    <h5 className=\"font-weight-bold d-flex align-items-center\">\r\n                      Grand Total:\r\n                      <span> &#8369; {totalAmount}</span>\r\n                    </h5>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </Form>\r\n          </Fragment>\r\n        </div>\r\n      ) : (\r\n        \"No bid winner in this product\"\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CreateInvoice;\r\n"],"sourceRoot":""}