{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\SMASH-PC\\\\Desktop\\\\furniturebidding\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\SMASH-PC\\\\Desktop\\\\furniturebidding\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\SMASH-PC\\\\Desktop\\\\furniturebidding\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import{PaymentElement}from\"@stripe/react-stripe-js\";import{useStripe,useElements}from\"@stripe/react-stripe-js\";import{useHistory}from\"react-router-dom\";import{addOrder,updateOrder}from\"app/reducers/actions/FurnitureActions\";import{useAuth}from\"app/appContext\";var PaymentForm=function PaymentForm(_ref){var orderId=_ref.orderId;var _useAuth=useAuth(),dispatch=_useAuth.dispatch;var stripe=useStripe();var elements=useElements();var history=useHistory();var _useState=useState(null),_useState2=_slicedToArray(_useState,2),message=_useState2[0],setMessage=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isProcessing=_useState4[0],setIsProcessing=_useState4[1];var handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var _yield$stripe$confirm,error;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();if(!(!stripe||!elements)){_context.next=3;break;}return _context.abrupt(\"return\");case 3:setIsProcessing(true);_context.next=6;return updateOrder(orderId,{isPaid:true})(dispatch);case 6:_context.next=8;return stripe.confirmPayment({elements:elements,confirmParams:{// Make sure to change this to your payment completion page\nreturn_url:history.push(\"/home\")}});case 8:_yield$stripe$confirm=_context.sent;error=_yield$stripe$confirm.error;if(error.type===\"card_error\"||error.type===\"validation_error\"){setMessage(error.message);}else{setMessage(\"An unexpected error occured.\");}setIsProcessing(false);case 12:case\"end\":return _context.stop();}}},_callee);}));return function handleSubmit(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(\"form\",{id:\"payment-form\",onSubmit:handleSubmit},/*#__PURE__*/React.createElement(PaymentElement,{id:\"payment-element\"}),/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-primary\",disabled:isProcessing||!stripe||!elements,id:\"submit\"},/*#__PURE__*/React.createElement(\"span\",{id:\"button-text\"},isProcessing?\"Processing ... \":\"Pay now\")),message&&/*#__PURE__*/React.createElement(\"div\",{id:\"payment-message\"},message));};export default PaymentForm;","map":{"version":3,"sources":["C:/Users/SMASH-PC/Desktop/furniturebidding/frontend/src/app/views/account/components/PaymentForm.js"],"names":["React","useState","PaymentElement","useStripe","useElements","useHistory","addOrder","updateOrder","useAuth","PaymentForm","orderId","dispatch","stripe","elements","history","message","setMessage","isProcessing","setIsProcessing","handleSubmit","e","preventDefault","isPaid","confirmPayment","confirmParams","return_url","push","error","type"],"mappings":"yhBAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CACA,OAASC,cAAT,KAA+B,yBAA/B,CACA,OAASC,SAAT,CAAoBC,WAApB,KAAuC,yBAAvC,CACA,OAASC,UAAT,KAA2B,kBAA3B,CACA,OAASC,QAAT,CAAmBC,WAAnB,KAAsC,uCAAtC,CACA,OAASC,OAAT,KAAwB,gBAAxB,CACA,GAAMC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,MAAiB,IAAdC,CAAAA,OAAc,MAAdA,OAAc,cACdF,OAAO,EADO,CAC3BG,QAD2B,UAC3BA,QAD2B,CAEnC,GAAMC,CAAAA,MAAM,CAAGT,SAAS,EAAxB,CACA,GAAMU,CAAAA,QAAQ,CAAGT,WAAW,EAA5B,CACA,GAAMU,CAAAA,OAAO,CAAGT,UAAU,EAA1B,CAJmC,cAKLJ,QAAQ,CAAC,IAAD,CALH,wCAK5Bc,OAL4B,eAKnBC,UALmB,8BAMKf,QAAQ,CAAC,KAAD,CANb,yCAM5BgB,YAN4B,eAMdC,eANc,eAQnC,GAAMC,CAAAA,YAAY,2FAAG,iBAAOC,CAAP,kJACnBA,CAAC,CAACC,cAAF,GADmB,KAGf,CAACT,MAAD,EAAW,CAACC,QAHG,kEASnBK,eAAe,CAAC,IAAD,CAAf,CATmB,sBAUbX,CAAAA,WAAW,CAACG,OAAD,CAAU,CAAEY,MAAM,CAAE,IAAV,CAAV,CAAX,CAAuCX,QAAvC,CAVa,8BAWKC,CAAAA,MAAM,CAACW,cAAP,CAAsB,CAC5CV,QAAQ,CAARA,QAD4C,CAE5CW,aAAa,CAAE,CACb;AACAC,UAAU,CAAEX,OAAO,CAACY,IAAR,CAAa,OAAb,CAFC,CAF6B,CAAtB,CAXL,4CAWXC,KAXW,uBAWXA,KAXW,CAmBnB,GAAIA,KAAK,CAACC,IAAN,GAAe,YAAf,EAA+BD,KAAK,CAACC,IAAN,GAAe,kBAAlD,CAAsE,CACpEZ,UAAU,CAACW,KAAK,CAACZ,OAAP,CAAV,CACD,CAFD,IAEO,CACLC,UAAU,CAAC,8BAAD,CAAV,CACD,CAEDE,eAAe,CAAC,KAAD,CAAf,CAzBmB,uDAAH,kBAAZC,CAAAA,YAAY,6CAAlB,CA2BA,mBACE,4BAAM,EAAE,CAAC,cAAT,CAAwB,QAAQ,CAAEA,YAAlC,eACE,oBAAC,cAAD,EAAgB,EAAE,CAAC,iBAAnB,EADF,cAEE,8BACE,SAAS,CAAC,iBADZ,CAEE,QAAQ,CAAEF,YAAY,EAAI,CAACL,MAAjB,EAA2B,CAACC,QAFxC,CAGE,EAAE,CAAC,QAHL,eAKE,4BAAM,EAAE,CAAC,aAAT,EACGI,YAAY,CAAG,iBAAH,CAAuB,SADtC,CALF,CAFF,CAYGF,OAAO,eAAI,2BAAK,EAAE,CAAC,iBAAR,EAA2BA,OAA3B,CAZd,CADF,CAgBD,CAnDD,CAqDA,cAAeN,CAAAA,WAAf","sourcesContent":["import React, { useState } from \"react\";\r\nimport { PaymentElement } from \"@stripe/react-stripe-js\";\r\nimport { useStripe, useElements } from \"@stripe/react-stripe-js\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { addOrder, updateOrder } from \"app/reducers/actions/FurnitureActions\";\r\nimport { useAuth } from \"app/appContext\";\r\nconst PaymentForm = ({ orderId }) => {\r\n  const { dispatch } = useAuth();\r\n  const stripe = useStripe();\r\n  const elements = useElements();\r\n  const history = useHistory();\r\n  const [message, setMessage] = useState(null);\r\n  const [isProcessing, setIsProcessing] = useState(false);\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n\r\n    if (!stripe || !elements) {\r\n      // Stripe.js has not yet loaded.\r\n      // Make sure to disable form submission until Stripe.js has loaded.\r\n      return;\r\n    }\r\n\r\n    setIsProcessing(true);\r\n    await updateOrder(orderId, { isPaid: true })(dispatch);\r\n    const { error } = await stripe.confirmPayment({\r\n      elements,\r\n      confirmParams: {\r\n        // Make sure to change this to your payment completion page\r\n        return_url: history.push(\"/home\"),\r\n      },\r\n    });\r\n\r\n    if (error.type === \"card_error\" || error.type === \"validation_error\") {\r\n      setMessage(error.message);\r\n    } else {\r\n      setMessage(\"An unexpected error occured.\");\r\n    }\r\n\r\n    setIsProcessing(false);\r\n  };\r\n  return (\r\n    <form id=\"payment-form\" onSubmit={handleSubmit}>\r\n      <PaymentElement id=\"payment-element\" />\r\n      <button\r\n        className=\"btn btn-primary\"\r\n        disabled={isProcessing || !stripe || !elements}\r\n        id=\"submit\"\r\n      >\r\n        <span id=\"button-text\">\r\n          {isProcessing ? \"Processing ... \" : \"Pay now\"}\r\n        </span>\r\n      </button>\r\n      {/* Show any error or success messages */}\r\n      {message && <div id=\"payment-message\">{message}</div>}\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default PaymentForm;\r\n"]},"metadata":{},"sourceType":"module"}